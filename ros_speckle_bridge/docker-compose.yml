# Docker Compose for ROS Speckle Bridge
version: '3.8'

services:
  speckle_bridge:
    build:
      context: ../
      dockerfile: ros_speckle_bridge/Dockerfile
      args:
        ROS_DISTRO: humble
    container_name: ros_speckle_bridge
    network_mode: host
    environment:
      - SPECKLE_TOKEN=${SPECKLE_TOKEN}
      - ROS_DOMAIN_ID=${ROS_DOMAIN_ID:-0}
    volumes:
      # Mount cache directory for offline operation
      - speckle_cache:/root/.ros/speckle_cache
      # Optional: Mount config for easy parameter updates
      - ./config/params.yaml:/workspace/install/ros_speckle_bridge/share/ros_speckle_bridge/config/params.yaml:ro
    restart: unless-stopped

volumes:
  speckle_cache:
    driver: local
